package jetlinks.szy206.protocol;

import com.alibaba.fastjson.JSONArray;
import io.netty.buffer.ByteBufUtil;
import io.netty.buffer.Unpooled;
import io.vertx.core.buffer.Buffer;
import lombok.SneakyThrows;
import org.apache.commons.codec.DecoderException;
import org.apache.commons.codec.binary.Hex;
import org.jetlinks.pro.network.tcp.parser.strateies.PipePayloadParser;
import org.jetlinks.szy206.protocol.message.binary.BinaryMessageType;
import org.jetlinks.szy206.protocol.message.utils.HexUtils;
import org.junit.Test;


public class Szy206ProtocolApplicationTests {

    @Test
    public void test01() throws DecoderException {
        String data = "681A68B35303810D00C00059000000826110000001106000004508090A3516";
        byte[] payload = Hex.decodeHex(data);
        BinaryMessageType.read(Unpooled.wrappedBuffer(payload), null);

    }

    @Test
    public void test02() throws DecoderException {
        String data = "004508090A";
        byte[] payload = Hex.decodeHex(data);
        JSONArray properties = new JSONArray();
        HexUtils.resolveTp(Unpooled.wrappedBuffer(payload), properties);
    }

    @Test
    public void test03() throws DecoderException {
        String data = "8261100000";
        System.out.println(HexUtils.byteBuf2BigDecimal(Unpooled.wrappedBuffer(Hex.decodeHex(data)), 0, true, true));
    }


    @Test
    public void test04() throws DecoderException {
        String data= "51611625948FE23514AECC99CF1516FDDD69C1C79441FC2AEC32263C9258F355657C13EBDCD5A241E33504E8A55988ED4EC05290F3D060F34D57E324F1F4A7160C327B53381C8A0052AB8CF7A61519C9E47BD203B49C1A46624FBD031491DBAD37AB73CD203CD3493D4F22980849E84F7A40C734D3D79E2939A603816CE49FC69A5B3D7A0A4248EBFCE9BBBD2980A5B8C753D69A5B8CF5FC691F20B061823B5309E33FD298876F3D724D207ED9E3AD46CDC75A4DDEA681126FE7D690329E7A9A8CE0F5A4C9E074A604A5B192BD2985CF4CFE14DC9DBDF029404FBCC7DE819197DDCF5A61E5B3E95286F3327A60E3069855BAFE94C08FE6E49E39AD6F054665F1A698A5BE5567724FB29FFEB5651240FF000ADBF87CA1FC636AA46008A423F21401ADE20932C01180257E0FB13544A3C722AB1C97407F3AB3AE3798E982072C78FAFF00FAEA097E5BA4CB67E4079AA28BF1B0214E73B579AB30E4908DCEEE3EB54EDB1E4263A9C939FAFF00FAAACC4D8742A7E65F981F4A6210A191A3B7E9E64EA87E80E4D696AB7465D4E764236C4DB508ED818FE79AA30385BC49CF26325FEA49EB48090ACCC7E620B37EA4FEB5449BFA5BAC5E04BA8EE371FED1BC486308C410ACEB1290473F78B9FC2BA129A45F69BF6CD7F4FB692682CE7B7BC72B8304E063CF8DB04A86023938FEF1F4AE6276F26E34FB0DC47D8215B861FF004D1149527FEDB37EB52F84E41696514F70C92457B70F04C256C8084ED0C73D464B03EC7DAA2435A6A64697335C6911492604E23513A8E9B8F71EC6B45FFD5A607F10ED5A5E3CF0F69FA045697BA4D9D9C1690BA69F3ADA657CF94B1712053CE3601F8D66B71819DC370DA4771EB5C935667A309732B8B22EFB6910F4618EBEF577C39A8DDE87AB43A8DA10D2227972C6C485B88B3CA363A1EE0F63F88354FDC3CF7A936060B919C1EB4931B44B1CBE31592F2E2D7C5D721624123F9991B1772A8FB8CB93961FCEBB1F0B5CEA171E1EB69B57BE4BDBD7672F2A4657237103A9249C77AE3343D4A2D3B5A92E6F2D4DD5934856EE1032C133FEB13DC75C771C7A57AE49A5D9CDA7D9CFA44B6E91EC06370C1629A2232181E80FF3FA8AEAA3525CD69339ABC21C978AD4C612A93C1FD29ECC0805549F5E2B41B4AD4042F38B6591235DCED1CA8F81EB80738AA99C0271CFA577DCF38ADB8139239F4A7AE776E1CFAE2A46556E7B8E69AA4AF6E2980EDC0F23F11504D107C91F7BD2A5C83CF71DA8C863D39EF4C0C9B8B71F324A80A91C823B53742D5F50F0DC2D670DA26B3A2336E3A5DCB711B7F7A173FEACFB0E3E9D6B59D149CF39AA935B29C86E33DBB50D296E34CD6D5AC4EB1A10D5FC2263D674D27377A4DC3817364C7AF39CA91FFD7E4735E68FA16B726B57AEFA25D8B68C0786E239E297E50B83B9158B63AF38AEA60373A56A49A8";
        System.out.println(data.length()/2);
    }

    /**
     * 粘拆包
     */
    @Test
    @SneakyThrows
    public void test23() throws DecoderException {
        PipePayloadParser parser = new PipePayloadParser();
        parser
            .fixed(1)
            .handler((buf, _parser) -> {
                if (buf.getByte(0) == 0x68) {
                    _parser.result(buf).fixed(1);
                } else {
                    _parser.complete();
                }
            })
            .fixed(1)
            .handler((buf, _parser) -> {
                if (buf.getByte(0) == 0x01) {
                    _parser.result(buf).fixed(11)
                           .handler((bufNew, _parserNew) -> {
                               int tempLen = bufNew.getShortLE(9);
                               _parserNew
                                   .result(bufNew)
                                   .fixed(tempLen + 2)
                                   .handler((buffer, pipePayloadParser) -> {
                                       pipePayloadParser.result(buffer)
                                                        .complete();
                                   });
                           });
                } else {
                    int len = buf.getByte(0);
                    _parser.result(buf).fixed(len + 3).handler((bufNew, _parserNew) -> {
                        _parserNew
                            .result(bufNew)
                            .complete();
                    });
                }
            });


        parser.handlePayload()
                  .

              subscribe(buf ->

                        {
                            System.out.println(ByteBufUtil.hexDump(buf.getByteBuf()));
                        });

//        byte[] data1 = Hex.decodeHex(("681568B34406070001C0AAAAAAAAAA00404000000000").replace(" ", ""));
//        byte[] data2 = Hex.decodeHex(("0101E516").replace(" ", ""));
//        byte[] data3 = Hex.decodeHex((
//            "681568B34406070001C0AAAAAAAAAA004040000000000101E516681568B34406070001C0AAAAAAAAAA0040400000").replace(" ", ""));
//        byte[] data4 = Hex.decodeHex(("00000101E516").replace(" ", ""));
        byte[] data5 =
            Hex.decodeHex(
                "680168F02A440607000161000451611625948FE23514AECC99CF1516FDDD69C1C79441FC2AEC32263C9258F355657C13EBDCD5A241E33504E8A55988ED4EC05290F3D060F34D57E324F1F4A7160C327B53381C8A0052AB8CF7A61519C9E47BD203B49C1A46624FBD031491DBAD37AB73CD203CD3493D4F22980849E84F7A40C734D3D79E2939A603816CE49FC69A5B3D7A0A4248EBFCE9BBBD2980A5B8C753D69A5B8CF5FC691F20B061823B5309E33FD298876F3D724D207ED9E3AD46CDC75A4DDEA681126FE7D690329E7A9A8CE0F5A4C9E074A604A5B192BD2985CF4CFE14DC9DBDF029404FBCC7DE819197DDCF5A61E5B3E95286F3327A60E3069855BAFE94C08FE6E49E39AD6F054665F1A698A5BE5567724FB29FFEB5651240FF000ADBF87CA1FC636AA46008A423F21401ADE20932C01180257E0FB13544A3C722AB1C97407F3AB3AE3798E982072C78FAFF00FAEA097E5BA4CB67E4079AA28BF1B0214E73B579AB30E4908DCEEE3EB54EDB1E4263A9C939FAFF00FAAACC4D8742A7E65F981F4A6210A191A3B7E9E64EA87E80E4D696AB7465D4E764236C4DB508ED818FE79AA30385BC49CF26325FEA49EB48090ACCC7E620B37EA4FEB5449BFA5BAC5E04BA8EE371FED1BC486308C410ACEB1290473F78B9FC2BA129A45F69BF6CD7F4FB692682CE7B7BC72B8304E063CF8DB04A86023938FEF1F4AE6276F26E34FB0DC47D8215B861FF004D1149527FEDB37EB52F84E41696514F70C92457B70F04C256C8084ED0C73D464B03EC7DAA2435A6A64697335C6911492604E23513A8E9B8F71EC6B45FFD5A607F10ED5A5E3CF0F69FA045697BA4D9D9C1690BA69F3ADA657CF94B1712053CE3601F8D66B71819DC370DA4771EB5C935667A309732B8B22EFB6910F4618EBEF577C39A8DDE87AB43A8DA10D2227972C6C485B88B3CA363A1EE0F63F88354FDC3CF7A936060B919C1EB4931B44B1CBE31592F2E2D7C5D721624123F9991B1772A8FB8CB93961FCEBB1F0B5CEA171E1EB69B57BE4BDBD7672F2A4657237103A9249C77AE3343D4A2D3B5A92E6F2D4DD5934856EE1032C133FEB13DC75C771C7A57AE49A5D9CDA7D9CFA44B6E91EC06370C1629A2232181E80FF3FA8AEAA3525CD69339ABC21C978AD4C612A93C1FD29ECC0805549F5E2B41B4AD4042F38B6591235DCED1CA8F81EB80738AA99C0271CFA577DCF38ADB8139239F4A7AE776E1CFAE2A46556E7B8E69AA4AF6E2980EDC0F23F11504D107C91F7BD2A5C83CF71DA8C863D39EF4C0C9B8B71F324A80A91C823B53742D5F50F0DC2D670DA26B3A2336E3A5DCB711B7F7A173FEACFB0E3E9D6B59D149CF39AA935B29C86E33DBB50D296E34CD6D5AC4EB1A10D5FC2263D674D27377A4DC3817364C7AF39CA91FFD7E4735E68FA16B726B57AEFA25D8B68C0786E239E297E50B83B9158B63AF38AEA60373A56A49A82016".replace(" ", ""));
        byte[] data6 =
            Hex.decodeHex(
                "680168F02A440607000161000451611625948FE23514AECC99CF1516FDDD69C1C79441FC2AEC32263C9258F355657C13EBDCD5A241E33504E8A55988ED4EC05290F3D060F34D57E324F1F4A7160C327B53381C8A0052AB8CF7A61519C9E47BD203B49C1A46624FBD031491DBAD37AB73CD203CD3493D4F22980849E84F7A40C734D3D79E2939A603816CE49FC69A5B3D7A0A4248EBFCE9BBBD2980A5B8C753D69A5B8CF5FC691F20B061823B5309E33FD298876F3D724D207ED9E3AD46CDC75A4DDEA681126FE7D690329E7A9A8CE0F5A4C9E074A604A5B192BD2985CF4CFE14DC9DBDF029404FBCC7DE819197DDCF5A61E5B3E95286F3327A60E3069855BAFE94C08FE6E49E39AD6F054665F1A698A5BE5567724FB29FFEB5651240FF000ADBF87CA1FC636AA46008A423F21401ADE20932C01180257E0FB13544A3C722AB1C97407F3AB3AE3798E982072C78FAFF00FAEA097E5BA4CB67E4079AA28BF1B0214E73B579AB30E4908DCEEE3EB54EDB1E4263A9C939FAFF00FAAACC4D8742A7E65F981F4A6210A191A3B7E9E64EA87E80E4D696AB7465D4E764236C4DB508ED818FE79AA30385BC49CF26325FEA49EB48090ACCC7E620B37EA4FEB5449BFA5BAC5E04BA8EE371FED1BC486308C410ACEB1290473F78B9FC2BA129A45F69BF6CD7F4FB692682CE7B7BC72B8304E063CF8DB04A86023938FEF1F4AE6276F26E34FB0DC47D8215B861FF004D1149527FEDB37EB52F84E41696514F70C92457B70F04C256C8084ED0C73D464B03EC7DAA2435A6A64697335C6911492604E23513A8E9B8F71EC6B45FFD5A607F10ED5A5E3CF0F69FA045697BA4D9D9C1690BA69F3ADA657CF94B1712053CE3601F8D66B71819DC370DA4771EB5C935667A309732B8B22EFB6910F4618EBEF577C39A8DDE87AB43A8DA10D2227972C6C485B88B3CA363A1EE0F63F88354FDC3CF7A936060B919C1EB4931B44B1CBE31592F2E2D7C5D721624123F9991B1772A8FB8CB93961FCEBB1F0B5CEA171E1EB69B57BE4BDBD7672F2A4657237103A9249C77AE3343D4A2D3B5A92E6F2D4DD5934856EE1032C133FEB13DC75C771C7A57AE49A5D9CDA7D9CFA44B6E91EC06370C1629A2232181E80FF3FA8AEAA3525CD69339ABC21C978AD4C612A93C1FD29ECC0805549F5E2B41B4AD4042F38B6591235DCED1CA8F81EB80738AA99C0271CFA577DCF38ADB8139239F4A7AE776E1CFAE2A46556E7B8E69AA4AF6E2980EDC0F23F11504D107C91F7BD2A5C83CF71DA8C863D39EF4C0C9B8B71F324A80A91C823B53742D5F50F0DC2D670DA26B3A2336E3A5DCB711B7F7A173FEACFB0E3E9D6B59D149CF39AA935B29C86E33DBB50D296E34CD6D5AC4EB1A10D5FC2263D674D27377A4DC3817364C7AF39CA91FFD7E4735E68FA16B726B57AEFA25D8B68C0786E239E297E50B83B9158B63AF38AEA60373A56A49A82016680168F02A440607000161000451611625948FE23514AECC99CF1516FDDD69C1C79441FC2AEC32263C9258F355657C13EBDCD5A241E33504E8A55988ED4EC05290F3D060F34D57E324F1F4A7160C327B53381C8A0052AB8CF7A61519C9E47BD203B49C1A46624FBD031491DBAD37AB73CD203CD3493D4F22980849E84F7A40C734D3D79E2939A603816CE49FC69A5B3D7A0A4248EBFCE9BBBD2980A5B8C753D69A5B8CF5FC691F20B061823B5309E33FD298876F3D724D207ED9E3AD46CDC75A4DDEA681126FE7D690329E7A9A8CE0F5A4C9E074A604A5B192BD2985CF4CFE14DC9DBDF029404FBCC7DE819197DDCF5A61E5B3E95286F3327A60E3069855BAFE94C08FE6E49E39AD6F054665F1A698A5BE5567724FB29FFEB5651240FF000ADBF87CA1FC636AA46008A423F21401ADE20932C01180257E0FB13544A3C722AB1C97407F3AB3AE3798E982072C78FAFF00FAEA097E5BA4CB67E4079AA28BF1B0214E73B579AB30E4908DCEEE3EB54EDB1E4263A9C939FAFF00FAAACC4D8742A7E65F981F4A6210A191A3B7E9E64EA87E80E4D696AB7465D4E764236C4DB508ED818FE79AA30385BC49CF26325FEA49EB48090ACCC7E620B37EA4FEB5449BFA5BAC5E04BA8EE371FED1BC486308C410ACEB1290473F78B9FC2BA129A45F69BF6CD7F4FB692682CE7B7BC72B8304E063CF8DB04A86023938FEF1F4AE6276F26E34FB0DC47D8215B861FF004D1149527FEDB37EB52F84E41696514F70C92457B70F04C256C8084ED0C73D464B03EC7DAA2435A6A64697335C6911492604E23513A8E9B8F71EC6B45FFD5A607F10ED5A5E3CF0F69FA045697BA4D9D9C1690BA69F3ADA657CF94B1712053CE3601F8D66B71819DC370DA4771EB5C935667A309732B8B22EFB6910F4618EBEF577C39A8DDE87AB43A8DA10D2227972C6C485B88B3CA363A1EE0F63F88354FDC3CF7A936060B919C1EB4931B44B1CBE31592F2E2D7C5D721624123F9991B1772A8FB8CB93961FCEBB1F0B5CEA171E1EB69B57BE4BDBD7672F2A4657237103A9249C77AE3343D4A2D3B5A92E6F2D4DD5934856EE1032C133FEB13DC75C771C7A57AE49A5D9CDA7D9CFA44B6E91EC06370C1629A2232181E80FF3FA8AEAA3525CD69339ABC21C978AD4C612A93C1FD29ECC0805549F5E2B41B4AD4042F38B6591235DCED1CA8F81EB80738AA99C0271CFA577DCF38ADB8139239F4A7AE776E1CFAE2A46556E7B8E69AA4AF6E2980EDC0F23F11504D107C91F7BD2A5C83CF71DA8C863D39EF4C0C9B8B71F324A80A91C823B53742D5F50F0DC2D670DA26B3A2336E3A5DCB711B7F7A173FEACFB0E3E9D6B59D149CF39AA935B29C86E33DBB50D296E34CD6D5AC4EB1A10D5FC2263D674D27377A4DC3817364C7AF39CA91FFD7E4735E68FA16B726B57AEFA25D8B68C0786E239E297E50B83B9158B63AF38AEA60373A56A49A82016".replace(" ", ""));
        byte[] data7 =
            Hex.decodeHex(
                "680168F02A440607000161000451611625948FE23514AECC99CF1516FDDD69C1C79441FC2AEC32263C9258F355657C13EBDCD5A241E33504E8A55988ED4EC05290F3D060F34D57E324F1F4A7160C327B53381C8A0052AB8CF7A61519C9E47BD203B49C1A46624FBD031491DBAD37AB73CD203CD3493D4F22980849E84F7A40C734D3D79E2939A603816CE49FC69A5B3D7A0A4248EBFCE9BBBD2980A5B8C753D69A5B8CF5FC691F20B061823B5309E33FD298876F3D724D207ED9E3AD46CDC75A4DDEA681126FE7D690329E7A9A8CE0F5A4C9E074A604A5B192BD2985CF4CFE14DC9DBDF029404FBCC7DE819197DDCF5A61E5B3E95286F3327A60E3069855BAFE94C08FE6E49E39AD6F054665F1A698A5BE5567724FB29FFEB5651240FF000ADBF87CA1FC636AA46008A423F21401ADE20932C01180257E0FB13544A3C722AB1C97407F3AB3AE3798E982072C78FAFF00FAEA097E5BA4CB67E4079AA28BF1B0214E73B579AB30E4908DCEEE3EB54EDB1E4263A9C939FAFF00FAAACC4D8742A7E65F981F4A6210A191A3B7E9E64EA87E80E4D696AB7465D4E764236C4DB508ED818FE79AA30385BC49CF26325FEA49EB48090ACCC7E620B37EA4FEB5449BFA5BAC5E04BA8EE371FED1BC486308C410ACEB1290473F78B9FC2BA129A45F69BF6CD7F4FB692682CE7B7BC72B8304E063CF8DB04A86023938FEF1F4AE6276F26E34FB0DC47D8215B861FF004D1149527FEDB37EB52F84E41696514F70C92457B70F04C256C8084ED0C73D464B03EC7DAA2435A6A64697335C6911492604E23513A8E9B8F71EC6B45FFD5A607F10ED5A5E3CF0F69FA045697BA4D9D9C1690BA69F3ADA657CF94B1712053CE3601F8D66B71819DC370DA4771EB5C935667A309732B8B22EFB6910F4618EBEF577C39A8DDE87AB43A8DA10D2227972C6C485B88B3CA363A1EE0F63F88354FDC3CF7A936060B919C1EB4931B44B1CBE31592F2E2D7C5D721624123F9991B1772A8FB8CB93961FCEBB1F0B5CEA171E1EB69B57BE4BDBD7672F2A4657237103A9249C77AE3343D4A2D3B5A92E6F2D4DD5934856EE1032C133FEB13DC75C771C7A57AE49A5D9CDA7D9CFA44B6E91EC06370C1629A2232181E80FF3FA8AEAA3525CD69339ABC21C978AD4C612A93C1FD29ECC0805549F5E2B41B4AD4042F38B6591235DCED1CA8F81EB80738AA99C0271CFA577DCF38ADB8139239F4A7AE776E1CFAE2A46556E7B8E69AA4AF6E2980EDC0F23F11504D107C91F7BD2A5C83CF71DA8C863D39EF4C0C9B8B71F324A80A91C823B53742D5F50F0DC2D670DA26B3A2336E3A5DCB711B7F7A173FEACFB0E3E9D6B59D149CF39AA935B29C86E33DBB50D296E34CD6D5AC4EB1A10D5FC2263D674D27377A4DC3817364C7AF39CA91FFD7E4735E68FA16B726B57AEFA25D8B68C0786E239E297E50B83B9158B63AF38AEA60373A56A49A82016680168F02A440607000161000451611625948FE23514AECC99CF1516FDDD69C1C79441FC2AEC32263C9258F355657C13EBDCD5A241E33504E8A55988ED4EC05290F3D060F34D57E324F1F4A7160C327B53381C8A0052AB8CF7A61519C9E47BD203B49C1A46624FBD031491DBAD37AB73CD203CD3493D4F22980849E84F7A40C734D3D79E2939A603816CE49FC69A5B3D7A0A4248EBFCE9BBBD2980A5B8C753D69A5B8CF5FC691F20B061823B5309E33FD298876F3D724D207ED9E3AD46CDC75A4DDEA681126FE7D690329E7A9A8CE0F5A4C9E074A604A5B192BD2985CF4CFE14DC9DBDF029404FBCC7DE819197DDCF5A61E5B3E95286F3327A60E3069855BAFE94C08FE6E49E39AD6F054665F1A698A5BE5567724FB29FFEB5651240FF000ADBF87CA1FC636AA46008A423F21401ADE20932C01180257E0FB13544A3C722AB1C97407F3AB3AE3798E982072C78FAFF00FAEA097E5BA4CB67E4079AA28BF1B0214E73B579AB30E4908DCEEE3EB54EDB1E4263A9C939FAFF00FAAACC4D8742A7E65F981F4A6210A191A3B7E9E64EA87E80E4D696AB7465D4E764236C4DB508ED818FE79AA30385BC49CF26325FEA49EB48090ACCC7E620B37EA4FEB5449BFA5BAC5E04BA8EE371FED1BC486308C410ACEB1290473F78B9FC2BA129A45F69BF6CD7F4FB692682CE7B7BC72B8304E063CF8DB04A86023938FEF1F4AE6276F26E34FB0DC47D8215B861FF004D1149527FEDB37EB52F84E41696514F70C92457B70F04C256C8084ED0C73D464B03EC7DAA2435A6A64697335C6911492604E23513A8E9B8F71EC6B45FFD5A607F10ED5A5E3CF0F69FA045697BA4D9D9C1690BA69F3ADA657CF94B1712053CE3601F8D66B71819DC370DA4771EB5C935667A309732B8B22EFB6910F4618EBEF577C39A8DDE87AB43A8DA10D2227972C6C485B88B3CA363A1EE0F63F88354FDC3CF7A936060B919C1EB4931B44B1CBE31592F2E2D7C5D721624123F9991B1772A8FB8CB93961FCEBB1F0B5CEA171E1EB69B57BE4BDBD7672F2A4657237103A9249C77AE3343D4A2D3B5A92E6F2D4DD5934856EE1032C133FEB13DC75C771C7A57AE49A5D9CDA7D9CFA44B6E91EC06370C1629A2232181E80FF3FA8AEAA3525CD69339ABC21C978AD4C612A93C1FD29ECC0805549F5E2B41B4AD4042F38B6591235DCED1CA8F81EB80738AA99C0271CFA577DCF38ADB8139239F4A7AE776E1CFAE2A46556E7B8E69AA4AF6E2980EDC0F23F11504D107C91F7BD2A5C83CF71DA8C863D39EF4C0C9B8B71F324A80A91C823B53742D5F50F0DC2D670DA26B3A2336E3A5DCB711B7F7A173FEACFB0E3E9D6B59D149CF39AA935B29C86E33DBB50D296E34CD6D5AC4EB1A10D5FC2263D674D27377A4DC3817364C7AF39CA91FFD7E4735E68FA16B726B57AEFA25D8B68C0786E239E297E50B83B9158B63AF38AEA60373A56A".replace(" ", ""));
        byte[] data8 =
            Hex.decodeHex(
                "49A82016".replace(" ", ""));
//        parser.handle(Buffer.buffer(data1));
//         parser.handle(Buffer.buffer(data2));
//        parser.handle(Buffer.buffer(data3));
//        parser.handle(Buffer.buffer(data4));
        parser.handle(Buffer.buffer(data5));
        parser.handle(Buffer.buffer(data6));
        parser.handle(Buffer.buffer(data7));
        parser.handle(Buffer.buffer(data8));

    }



}
